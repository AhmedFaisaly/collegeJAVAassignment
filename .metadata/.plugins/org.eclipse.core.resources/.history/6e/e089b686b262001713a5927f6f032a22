package connection;

import java.sql.Connection;
import java.sql.Date;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.RowId;
import java.sql.SQLException;
import java.sql.Timestamp;

import com.mysql.cj.api.jdbc.Statement;
import com.mysql.cj.jdbc.PreparedStatement;
import com.mysql.jdbc.Driver;

import java.util.Scanner;

public class configDatabase {
	private static Scanner input = new Scanner(System.in);
    private static Connection connection;
    private static ResultSet rs;
    private static java.sql.Statement statement;
    private final static String driver="com.mysql.cj.jdbc.Driver";
    private final static String url="jdbc:mysql://localhost:3306/sakila";
	private final static String user="root";
	private final static String password="ydong1Wang66";
    private final static String select="select * from actor";
    private final static String add="insert into actor values(?,?,?,?)";
    private final static String delete="";
    public static void main(String[] args) {
		// TODO Auto-generated method stub
		try {
			Class.forName(driver);
			System.out.println("loading driver successful...");
			connection=DriverManager.getConnection(url,user,password);
			System.out.println("connect to DB successful...");
			
			do{
				System.out.println("choose a option by 1,2 or 3\n 1.add data\n 2.delete data\n 3.update data\n 4.display table");
				int i=input.nextInt();
				switch(i){
				case 1: addDB();
				break;
				case 2: deleteDB();
				break;
				case 3: updateDB();
				break;
				case 4 :displayDB();
				default:
					break;
				
				}
				input=new Scanner(System.in);
				System.out.println("continue action ? y/n");
				String s=input.next();
				if(s.equalsIgnoreCase("y"))
				{
					continue;
				}else{
					break;
				}
			}while(true);
			
			
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public static void addDB() {
	System.out.println("enter actor_id");
	int id=input.nextInt();
	System.out.println("enter first name");
	String firstname=input.next();
	System.out.println("enter lastname ");
	String lastname=input.next();
	
	java.util.Date date=new java.util.Date();
    Timestamp	time=new Timestamp(date.getTime());
	
	try{
	java.sql.PreparedStatement pstmt=connection.prepareStatement(add);
    pstmt.setInt(1, id);
	pstmt.setString(2, firstname);
	pstmt.setString(3,lastname);
	pstmt.setTimestamp(4, time);
	pstmt.executeUpdate();
	pstmt.close();
	System.out.println("add data success..........");
	}catch(Exception e){
		e.printStackTrace();
		System.out.println("add failed");
	}
	}

	public static void deleteDB() {
	}

	public static void updateDB() {
	}

	public static void displayDB() throws Exception{
	
		statement=connection.createStatement();
		rs=statement.executeQuery(select);
		System.out.println("actor_table");
		System.out.println("actor_id\t"+"firstname\t"+"lastname");
		while (rs.next()){
			
			System.out.println(rs.getString(1)+" \t "+rs.getString(2)+"\t "+rs.getString(3));	
		}
	}
}
